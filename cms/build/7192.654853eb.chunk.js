"use strict";(self.webpackChunkprojectdes_cms=self.webpackChunkprojectdes_cms||[]).push([[7192],{22185:(x,m,s)=>{s.d(m,{T:()=>V});var t=s(92132),i=s(21272),h=s(94061),U=s(88353),L=s(83997),I=s(25641),_=s(90361),r=s(33363),a=s(30893),l=s(21610),e=s(21247),B=s(83925),K=s(41909),g=s(50612),W=s(54894),u=s(17703),z=s(71389),F=s(63891);const V=({permissions:n,headers:d=[],contentType:T,isLoading:D=!1,tokens:P=[],onConfirmDelete:M,tokenType:E})=>{const{canDelete:C,canUpdate:O,canRead:y}=n;return(0,t.jsx)(e.Ee,{headers:d,contentType:T,rows:P,withBulkActions:C||O||y,isLoading:D,onConfirmDelete:M,children:(0,t.jsx)(G,{tokenType:E,permissions:n,onConfirmDelete:M})})},G=({tokenType:n,permissions:d,rows:T=[],withBulkActions:D,onConfirmDelete:P})=>{const{canDelete:M,canUpdate:E,canRead:C}=d,[{query:O}]=(0,e.sq)(),{formatMessage:y}=(0,W.A)(),[,Z]=O&&O.sort?O.sort.split(":"):[void 0,"ASC"],{push:w,location:{pathname:b}}=(0,u.W6)(),{trackUsage:q}=(0,e.z1)(),ss=[...T].sort((o,ts)=>{const S=o.name.localeCompare(ts.name);return Z==="DESC"?-S:S});return(0,t.jsx)(I.N,{children:ss.map(o=>(0,t.jsxs)(_.Tr,{...(0,e.qM)({fn(){q("willEditTokenFromList",{tokenType:n}),w(`${b}/${o.id}`)},condition:E}),children:[(0,t.jsx)(r.Td,{maxWidth:(0,e.a8)(250),children:(0,t.jsx)(a.o,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:o.name})}),(0,t.jsx)(r.Td,{maxWidth:(0,e.a8)(250),children:(0,t.jsx)(a.o,{textColor:"neutral800",ellipsis:!0,children:o.description})}),(0,t.jsx)(r.Td,{children:(0,t.jsx)(a.o,{textColor:"neutral800",children:(0,t.jsx)(e.sR,{timestamp:new Date(o.createdAt)})})}),(0,t.jsx)(r.Td,{children:o.lastUsedAt&&(0,t.jsx)(a.o,{textColor:"neutral800",children:(0,t.jsx)(e.sR,{timestamp:new Date(o.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:y({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]})})}),D&&(0,t.jsx)(r.Td,{children:(0,t.jsxs)(L.s,{justifyContent:"end",children:[E&&(0,t.jsx)(X,{tokenName:o.name,tokenId:o.id}),!E&&C&&(0,t.jsx)(H,{tokenName:o.name,tokenId:o.id}),M&&(0,t.jsx)(Q,{tokenName:o.name,onClickDelete:()=>P?.(o.id),tokenType:n})]})})]},o.id))})},J={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},p=({tokenName:n,tokenId:d,buttonType:T="edit",children:D})=>{const{formatMessage:P}=(0,W.A)(),{location:{pathname:M}}=(0,u.W6)();return(0,t.jsx)(Y,{forwardedAs:z.k2,to:`${M}/${d}`,title:P(J[T],{target:n}),children:D})},Y=(0,F.default)(l.N)`
  svg {
    path {
      fill: ${({theme:n})=>n.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:n})=>n.colors.neutral800};
      }
    }
  }
`,Q=({tokenName:n,onClickDelete:d,tokenType:T})=>{const{formatMessage:D}=(0,W.A)(),{trackUsage:P}=(0,e.z1)(),[M,E]=i.useState(!1),C=()=>{E(!1),P("willDeleteToken",{tokenType:T}),d()};return(0,t.jsxs)(h.a,{paddingLeft:1,onClick:O=>O.stopPropagation(),children:[(0,t.jsx)(U.K,{onClick:()=>{E(!0)},label:D({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${n}`}),name:"delete",borderWidth:0,icon:(0,t.jsx)(g.A,{})}),(0,t.jsx)(e.TM,{onToggleDialog:()=>E(!1),onConfirm:C,isOpen:M})]})},H=({tokenName:n,tokenId:d})=>(0,t.jsx)(p,{tokenName:n,tokenId:d,buttonType:"read",children:(0,t.jsx)(B.A,{})}),X=({tokenName:n,tokenId:d})=>(0,t.jsx)(p,{tokenName:n,tokenId:d,children:(0,t.jsx)(K.A,{width:12})})},55167:(x,m,s)=>{s.d(m,{a:()=>L,b:()=>_,c:()=>h,d:()=>I,u:()=>U});var t=s(70573);const i=t.n.injectEndpoints({endpoints:r=>({getTransferTokens:r.query({query:()=>({url:"/admin/transfer/tokens",method:"GET"}),transformResponse:a=>a.data,providesTags:(a,l)=>[...a?.map(({id:e})=>({type:"TransferToken",id:e}))??[],{type:"TransferToken",id:"LIST"}]}),getTransferToken:r.query({query:a=>`/admin/transfer/tokens/${a}`,transformResponse:a=>a.data,providesTags:(a,l,e)=>[{type:"TransferToken",id:e}]}),createTransferToken:r.mutation({query:a=>({url:"/admin/transfer/tokens",method:"POST",data:a}),transformResponse:a=>a.data,invalidatesTags:[{type:"TransferToken",id:"LIST"}]}),deleteTransferToken:r.mutation({query:a=>({url:`/admin/transfer/tokens/${a}`,method:"DELETE"}),transformResponse:a=>a.data,invalidatesTags:(a,l,e)=>[{type:"TransferToken",id:e}]}),updateTransferToken:r.mutation({query:({id:a,...l})=>({url:`/admin/transfer/tokens/${a}`,method:"PUT",data:l}),transformResponse:a=>a.data,invalidatesTags:(a,l,{id:e})=>[{type:"TransferToken",id:e}]})}),overrideExisting:!1}),{useGetTransferTokensQuery:h,useGetTransferTokenQuery:U,useCreateTransferTokenMutation:L,useDeleteTransferTokenMutation:I,useUpdateTransferTokenMutation:_}=i},67192:(x,m,s)=>{s.d(m,{ProtectedListView:()=>rs});var t=s(92132),i=s(21272),h=s(4198),U=s(55356),L=s(25815),I=s(38413),_=s(21247),r=s(5194),a=s(5409),l=s(54894),e=s(17703),B=s(70573),K=s(55167),g=s(99831),W=s(22185),u=s(15126),z=s(63299),F=s(67014),V=s(59080),G=s(79275),J=s(14718),p=s(82437),Y=s(61535),Q=s(5790),H=s(12083),X=s(35223),n=s(74930),d=s(2600),T=s(48940),D=s(41286),P=s(56336),M=s(13426),E=s(84624),C=s(77965),O=s(54257),y=s(71210),Z=s(51187),w=s(39404),b=s(58692),q=s(501),ss=s(57646),o=s(23120),ts=s(44414),S=s(25962),Os=s(14664),ms=s(42588),As=s(90325),cs=s(62785),fs=s(87443),Ls=s(41032),gs=s(22957),Cs=s(93179),vs=s(73055),Rs=s(15747),hs=s(85306),Us=s(26509),Is=s(32058),Bs=s(81185),Ws=s(82261);const os=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],_s=()=>{(0,_.L4)();const{formatMessage:A}=(0,l.A)(),v=(0,_.hN)(),ds=(0,B.j)(f=>f.admin_app.permissions.settings?.["transfer-tokens"]),{isLoading:Es,allowedActions:{canCreate:k,canDelete:is,canUpdate:ls,canRead:R}}=(0,_.ec)(ds),{push:as}=(0,e.W6)(),{trackUsage:j}=(0,_.z1)(),{_unstableFormatAPIError:N}=(0,_.wq)();i.useEffect(()=>{as({search:a.stringify({sort:"name:ASC"},{encode:!1})})},[as]),(0,B.b)(()=>{j("willAccessTokenList",{tokenType:g.T})});const Ms=os.map(f=>({...f,metadatas:{...f.metadatas,label:A(f.metadatas.label)}})),{data:c=[],isLoading:Ts,error:$}=(0,K.c)(void 0,{skip:!R});i.useEffect(()=>{c&&j("didAccessTokenList",{number:c.length,tokenType:g.T})},[j,c]),i.useEffect(()=>{$&&v({type:"warning",message:N($)})},[$,N,v]);const[Ds]=(0,K.d)(),Ps=async f=>{try{const ns=await Ds(f);"error"in ns&&v({type:"warning",message:N(ns.error)})}catch{v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}},es=Ts||Es;return(0,t.jsxs)(I.g,{"aria-busy":es,children:[(0,t.jsx)(_.x7,{name:"Transfer Tokens"}),(0,t.jsx)(U.Q,{title:A({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:A({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:k?(0,t.jsx)(L.z,{"data-testid":"create-transfer-token-button",startIcon:(0,t.jsx)(r.A,{}),size:"S",onClick:()=>j("willAddTokenFromList",{tokenType:g.T}),to:"/settings/transfer-tokens/create",children:A({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})}):void 0}),(0,t.jsxs)(h.s,{children:[!R&&(0,t.jsx)(_.UW,{}),R&&c.length>0&&(0,t.jsx)(W.T,{permissions:{canRead:R,canDelete:is,canUpdate:ls},headers:Ms,contentType:"trasfer-tokens",isLoading:es,onConfirmDelete:Ps,tokens:c,tokenType:g.T}),R&&k&&c.length===0&&(0,t.jsx)(_.R1,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:(0,t.jsx)(L.z,{variant:"secondary",startIcon:(0,t.jsx)(r.A,{}),to:"/settings/transfer-tokens/create",children:A({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"})})}),R&&!k&&c.length===0&&(0,t.jsx)(_.R1,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})]})]})},rs=()=>{const A=(0,B.j)(v=>v.admin_app.permissions.settings?.["transfer-tokens"].main);return(0,t.jsx)(_.kz,{permissions:A,children:(0,t.jsx)(_s,{})})}},99831:(x,m,s)=>{s.d(m,{A:()=>t,T:()=>i});const t="api-token",i="transfer-token"}}]);
